{
    "componentChunkName": "component---src-pages-integration-invocationevents-mdx",
    "path": "/integration/invocationevents/",
    "result": {"pageContext":{"frontmatter":{"title":"Invoke channel scripting"},"relativePagePath":"/integration/invocationevents.mdx","titleType":"append","MdxNode":{"id":"5298f982-95eb-5133-8131-3f902ce42daf","children":[],"parent":"5d09d8a4-d633-540a-8199-da8d429b7026","internal":{"content":"---\ntitle: Invoke channel scripting\n---\n\nLike Publish channels, Invoke channels are used for outbound invocation from Maximo. \nThe only difference is that Publish channel is one way (request only) and Invoke Channel is two way (request response).\nSince there is a request and response, there will be two sets of exits - one set of exits for request and one set for response.\nThe following screen shot shows the wizard:\n\n\n![Invoke Channel Exits](invokechannelexit.jpg)  \n\n\nThe following table lists the script points for Invoke Channel:\n\n\n|Script Point|Purpose\n|:--------------|:---------------------------------------------------------------------------|\n|Oubound External Exit|This is for prepping the outbound call. This can be used to prepare the request data or the request URL (as shown in following example)|\n|Outbound Before User Exit|Similar to the outbound external exit, it can be used for preparing the data or the request endpoint data. Use this if there is already an external exit and you want to customize some data before it hits that exit.|\n|Outbound After User Exit|Similar to the outbound external exit, it can be used for preparing the data or the request endpoint data.|\n|Inbound External Exit|This is for handling the response of the invocation, if there is a response. Like any inbound external exit, this should be used to map the response data to Maximo internal format|\n|Inbound Before User Exit|Similar to the inbound external exit, it can be used for mapping the inbound data.|\n|Inbound After User Exit|Similar to the inbound external exit, it can be used for mapping the inbound data.|\n\n\nAll the outbound script points have the same variables as defined in publish channel scripting. \nAll inbound script points have the same variables as defined in the Enterprise service scripting document.\nThe use case here is to set the city and state in the **Organization Application->Address** tab when the zip code is entered. Assume you have the following external REST API:\n\n\nGET {zip to city uri}?zips={zip code}\n\n\nThe response is a json that returns the city and state for the {zip code}. You want to invoke\nthat API when the user enters the zip code and then tabs out (of attribute Address4). To do this,\nYou would need to create an Object Structure for the Address MBO, named for example, MXADDRESS.\nYou are then going to set-up an invoke channel with an HTTP endpoint that has the URL set to the\n{zip to city uri}. You are going to set the zips query parameter dynamically in the exit scripts.\nMake sure that you set the \"process response\" check box and set the request and response\nObject Structure to MXADDRESS.\n\n\nYou will then create the external exit scripts for both the request and response handling. You will\nuse the Create Scripts for Integration menu option from the Autoscript application to create the\nrequest and response exits for Invoke Channel. For both cases, you are going to choose the\n\"External Exit\" option. The following request (INVOKE.ZIPCHANNEL.EXTEXIT.OUT) exit (in py) will look\nlike: \n\n\n```python\nfrom java.util import HashMap\nfrom psdi.iface.router import HTTPHandler\nfrom psdi.iface.mic import IntegrationContext\nfrom psdi.iface.mic import MetaDataProperties\nepProps = HashMap()\nurlProps = HashMap()\nzip = irData.getCurrentData(\"ADDRESS4\");\nurlProps.put(\"zips\",zip)\nepProps.put(HTTPHandler.HTTPGET_URLPROPS,urlProps)\nIntegrationContext.getCurrentContext().setProperty(MetaDataProperties.ENDPOINTPROPS, epProps)\n```\n\nThe following response (INVOKE.ZIPCHANNEL.EXTEXIT.IN) exit (in js) will look like:\n\n\n```js\nvar resp = JSON.parse(erData.getDataAsString());\nvar irData = new StructureData(messageType, osName, userInfo.getLangCode(), 1, false, true);\nirData.setCurrentData(\"ADDRESS3\", resp.zips[0].state);\nirData.setCurrentData(\"ADDRESS2\", resp.zips[0].city);\n```\n\n\nThe following response json is assumed to be like this (based on a sample popular rest service out there):\n\n\n```\n{\n  \"zips\":[\n      {\n        \"state\":\"Blah\",\n        \"city\":\"Blah1\"\n        ….\n      }\n  ]\n}\n```\n\nThis script could have been optimized a little bit more for the given use case. For example, you\ncould have directly set the json data to the MBO, something that you can do only in case of\nInvoke Channels.\n\n\n```js\nIntegrationContext = Java.type(\"psdi.iface.mic.IntegrationContext\");\nvar resp = JSON.parse(erData.getDataAsString());\nvar mbo = IntegrationContext.getCurrentContext().getProperty(\"targetobject\");\nmbo.setValue(\"address3\",resp.zips[0].state);\nmbo.setValue(\"address2\",resp.zips[0].city);\nservice.raiseSkipTransaction();\n```\n\n\nYou got the MBO from the IntegrationContext \"targetobject\" property,\nwhich stores the reference of the MBO to which you are going to set the json response. Setting\nthe response can be done by MIF using the irData. In the following example, you will see how you can do it without needing to create the irData. You use the resp json object to get the state and city and set it directly to the “mbo”. Then you can just skip the rest of MIF processing by asking the service object to skip the transaction. You can\nuse this in other forms of inbound exits - like the user exit and the external exit for Enterprise\nservices. Make sure that you set the data yourself to the MBOs that you want and the skip the\nrest of MIF processing. Also, this IntegrationContext \"targetobject\" property is\nonly available for exits in InvokeChannel.\n\n\nYou will write an Attribute LaunchPoint script (action event) for the Address4 attribute (zip code attribute in\nAddress object) to invoke this channel when the zip code value is set.\n\n\n```\nservice.invokeChannel(\"zipchannel\")\n```\n\nYou use the service variable to do this call. This will call the channel, which in\nturn goes through the request and response exits.\n\n\n\n\n\n\n\n\n\n","type":"Mdx","contentDigest":"7a23a9689807304bdc1cfc48d77fcff5","owner":"gatsby-plugin-mdx","counter":192},"frontmatter":{"title":"Invoke channel scripting"},"exports":{},"rawBody":"---\ntitle: Invoke channel scripting\n---\n\nLike Publish channels, Invoke channels are used for outbound invocation from Maximo. \nThe only difference is that Publish channel is one way (request only) and Invoke Channel is two way (request response).\nSince there is a request and response, there will be two sets of exits - one set of exits for request and one set for response.\nThe following screen shot shows the wizard:\n\n\n![Invoke Channel Exits](invokechannelexit.jpg)  \n\n\nThe following table lists the script points for Invoke Channel:\n\n\n|Script Point|Purpose\n|:--------------|:---------------------------------------------------------------------------|\n|Oubound External Exit|This is for prepping the outbound call. This can be used to prepare the request data or the request URL (as shown in following example)|\n|Outbound Before User Exit|Similar to the outbound external exit, it can be used for preparing the data or the request endpoint data. Use this if there is already an external exit and you want to customize some data before it hits that exit.|\n|Outbound After User Exit|Similar to the outbound external exit, it can be used for preparing the data or the request endpoint data.|\n|Inbound External Exit|This is for handling the response of the invocation, if there is a response. Like any inbound external exit, this should be used to map the response data to Maximo internal format|\n|Inbound Before User Exit|Similar to the inbound external exit, it can be used for mapping the inbound data.|\n|Inbound After User Exit|Similar to the inbound external exit, it can be used for mapping the inbound data.|\n\n\nAll the outbound script points have the same variables as defined in publish channel scripting. \nAll inbound script points have the same variables as defined in the Enterprise service scripting document.\nThe use case here is to set the city and state in the **Organization Application->Address** tab when the zip code is entered. Assume you have the following external REST API:\n\n\nGET {zip to city uri}?zips={zip code}\n\n\nThe response is a json that returns the city and state for the {zip code}. You want to invoke\nthat API when the user enters the zip code and then tabs out (of attribute Address4). To do this,\nYou would need to create an Object Structure for the Address MBO, named for example, MXADDRESS.\nYou are then going to set-up an invoke channel with an HTTP endpoint that has the URL set to the\n{zip to city uri}. You are going to set the zips query parameter dynamically in the exit scripts.\nMake sure that you set the \"process response\" check box and set the request and response\nObject Structure to MXADDRESS.\n\n\nYou will then create the external exit scripts for both the request and response handling. You will\nuse the Create Scripts for Integration menu option from the Autoscript application to create the\nrequest and response exits for Invoke Channel. For both cases, you are going to choose the\n\"External Exit\" option. The following request (INVOKE.ZIPCHANNEL.EXTEXIT.OUT) exit (in py) will look\nlike: \n\n\n```python\nfrom java.util import HashMap\nfrom psdi.iface.router import HTTPHandler\nfrom psdi.iface.mic import IntegrationContext\nfrom psdi.iface.mic import MetaDataProperties\nepProps = HashMap()\nurlProps = HashMap()\nzip = irData.getCurrentData(\"ADDRESS4\");\nurlProps.put(\"zips\",zip)\nepProps.put(HTTPHandler.HTTPGET_URLPROPS,urlProps)\nIntegrationContext.getCurrentContext().setProperty(MetaDataProperties.ENDPOINTPROPS, epProps)\n```\n\nThe following response (INVOKE.ZIPCHANNEL.EXTEXIT.IN) exit (in js) will look like:\n\n\n```js\nvar resp = JSON.parse(erData.getDataAsString());\nvar irData = new StructureData(messageType, osName, userInfo.getLangCode(), 1, false, true);\nirData.setCurrentData(\"ADDRESS3\", resp.zips[0].state);\nirData.setCurrentData(\"ADDRESS2\", resp.zips[0].city);\n```\n\n\nThe following response json is assumed to be like this (based on a sample popular rest service out there):\n\n\n```\n{\n  \"zips\":[\n      {\n        \"state\":\"Blah\",\n        \"city\":\"Blah1\"\n        ….\n      }\n  ]\n}\n```\n\nThis script could have been optimized a little bit more for the given use case. For example, you\ncould have directly set the json data to the MBO, something that you can do only in case of\nInvoke Channels.\n\n\n```js\nIntegrationContext = Java.type(\"psdi.iface.mic.IntegrationContext\");\nvar resp = JSON.parse(erData.getDataAsString());\nvar mbo = IntegrationContext.getCurrentContext().getProperty(\"targetobject\");\nmbo.setValue(\"address3\",resp.zips[0].state);\nmbo.setValue(\"address2\",resp.zips[0].city);\nservice.raiseSkipTransaction();\n```\n\n\nYou got the MBO from the IntegrationContext \"targetobject\" property,\nwhich stores the reference of the MBO to which you are going to set the json response. Setting\nthe response can be done by MIF using the irData. In the following example, you will see how you can do it without needing to create the irData. You use the resp json object to get the state and city and set it directly to the “mbo”. Then you can just skip the rest of MIF processing by asking the service object to skip the transaction. You can\nuse this in other forms of inbound exits - like the user exit and the external exit for Enterprise\nservices. Make sure that you set the data yourself to the MBOs that you want and the skip the\nrest of MIF processing. Also, this IntegrationContext \"targetobject\" property is\nonly available for exits in InvokeChannel.\n\n\nYou will write an Attribute LaunchPoint script (action event) for the Address4 attribute (zip code attribute in\nAddress object) to invoke this channel when the zip code value is set.\n\n\n```\nservice.invokeChannel(\"zipchannel\")\n```\n\nYou use the service variable to do this call. This will call the channel, which in\nturn goes through the request and response exits.\n\n\n\n\n\n\n\n\n\n","fileAbsolutePath":"/home/travis/build/maximo-app-framework/maximo-autoscript-documentation/src/pages/integration/invocationevents.mdx"}}},
    "staticQueryHashes": ["1364590287","137577622","2102389209","2456312558","2746626797","3018647132","3037994772","768070550"]}