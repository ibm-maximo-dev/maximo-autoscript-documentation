{
    "componentChunkName": "component---src-pages-attributescripts-attributelaunch-mdx",
    "path": "/attributescripts/attributelaunch/",
    "result": {"pageContext":{"frontmatter":{"title":"Attribute launch point"},"relativePagePath":"/attributescripts/attributelaunch.mdx","titleType":"append","MdxNode":{"id":"aac4be74-348a-5990-8348-7d9c8d045eb4","children":[],"parent":"5ff34a14-1019-5c75-9bdd-79334f68e230","internal":{"content":"---\ntitle: Attribute launch point\n---\n\n## Attribute launch point\nYou can use the Attribute launch point to customize the field\nvalidation, action, initialization, and lookups in the scripting framework. The script can access to the event MBO using the implicit variable “mbo” as well as all the\nrelated MBOs. Additionally,the modified attribute would also be available implicitly\nas a variable inside the script. The variable name would be the lower case value\nof the modified attribute name. The script will have access to the event MBO using the implicit variable\n\"mbo\", the MboSet as well as all the related MBOs. The following examples explain the Attribute launch point. \nTo design scripts using Attribute launch point, start the **Create Scripts with Attribute Launch Point** wizard.\n\n![Attribute Launchpoint UI](alpui.jpg)\n\n\n### Validate and action events\nYou can customise the Asset MBO by adding custom business logic based on the Asset purchase price or attribute\npurchaseprice in Asset value. For example, to set the vendor field to\nrequired or not required based on the purchaseprice attribute value and also to\ncalculate the replacement cost based on the purchase price. You should also ensure that the purchase price does not exceed a maximum allowed value.  \n\nThe logic has to be injected at the modification\nof the purchasprice attribute value, which implies that it should be modeled as an\nAttribute Launch Point. There is a validation element in the requirement, where the purchaseprice cannot exceed a certain limit. \nThere is also an action element wherein the state of the vendor attribute and the replacementcost value gets set based on the purchaseprice value. \nThe first requirement (of validation) should be handled by the Attribute validate event and the second requirement should be handled in the Attribute action event. \nThe following figure shows the events available in Atribute Launchpoint wizard.\n\n\n![Attribute Event](aeuipage1.jpg)\n\nThe \"validate\" script should be quite simple:\n\n```python\nif purchaseprice > 200:\n  service.error(\"some\",\"error\")\n```\n\nYou can use the implicit variable `purchaseprice`, which is attribute on which the launch point is based on, and also use the `service.error(..) to throw the needed MXException for this validation.  \n\n\nThe following script would be for the Attribute Action event:\n\n```python\nif purchaseprice >= 100:\n  vend_required=True\nelse:\n  vend_required=False\n  rc = purchaseprice/2\n```\nThis script leverages two explicitly defined OUT variables, `vend` for attribute \"vendor\" and `rc` for attribute \"replacementcost\".\nBy leveraging the implicit variable vend_required you can control the state of the \"vendor\" attribute to required or not required. You can also set the \"replacementcost\" by setting the `rc`.\nAnother way to do this without using any of these explicitly defined variables is to leverage the standard MBO APIs and the implict \"mbo\" variable.  \n\n\n```python\nfrom psdi.mbo import MboConstants\n\nif purchaseprice >= 100:\n  mbo.setFieldFlag(\"vendor\",MboConstants.READONLY, True)\nelse:\n  mbo.setFieldFlag(\"vendor\",MboConstants.READONLY, False)\n  mbo.setValue(\"replacementcost\",purchaseprice/2)\n```  \nIf you use the standard MBO APIs and the implicit \"mbo\" variable, you have more control but you must be aware of the MBO APIs.\nFor example, if the \"replacementcost\" field is readonly, both scripts will fail as the MBO framework will reject the `setValue` call \non that attribute. \nA possible workaround is to leverage the variable binding metadata - \"Suppress Access Control\". By setting this metadata, the scripting framework can set the `rc` variable value to the \"replacementcost\" whether it is readonly or not.\nHowever, this will only work if the script code uses the variable binding. For scripts that use the MBO APIs, the script code will need to leverage the MboConstants setting to achieve the same.\n\n```python\nfrom psdi.mbo import MboConstants\n..\nmbo.setValue(\"replacementcost\",purchaseprice/2, MboConstants.NOACCESSCHECK)\n```  \n\nAnother use case is to make the calculated field created\nfor the Asset sparepart total quantity calculation more real-time. For example, if\nYou change the quantities of the related spareparts you should see the calculated\nfield [sparepartqty] value change real-time. To achieve this, you need to create a\nscript - attribute launchpoint for attribute \"quantity\" for \"sparepart\" object with the \"Action\" event. The explicit\nvariable binding is shown in the following table:  \n\n\n|Variable name|Variable type|Binding|\n|:-----------|:--------|:----------------------|\n|sptqt|INOUT|&owner&.sparepartqty|\n\n\nThe variable sptqt is bound to the owner's [Asset\nmbo] sparepartqty attribute. You must set the sptqt variable with the \"No\nAccess Check\" as it is marked as readonly by our original [Object launch point]\nscript when initializing the Asset MBO. The variable\nquantity, which is the attribute on which the script is listening to would be implicitly\ninjected in the script as that is the attribute on which the script is listening. The following script shows how it will look:\n\n\n```python\nsptqt=sptqt+quantity-quantity_previous\n```\n\n\nThe use of the implicit variable quantity_previous represents\nthe value of the quantity attribute before the modification, which is the value at the\ninitialization of the sparepart MBO. The variable quantity holds the\ncurrent modified value of the quantity attribute.  \n\n\nThe script and the Object Launch point script can give\nyou a complete calculated field logic implemented using the scripting framework\nwith three lines of script and simply executing the Script Wizard.  \n\n**Note:** Maximo formulas provide a simpler way to handle this use case. \n\n\n\n### Creating lookups using scripts\n\nYou can create lookups using the attribute launch point **Retrieve List** option. As with any\nattribute launchpoint, you must hook the script up with the MBO attribute on which you\nwant the lookup to happen. While writing the script is enough for lookups to work from REST APIs (`GET getlist~attr`), it is not enough for lookups to work either in Graphite or in classic UI. \nFor classic UI you are required to make an entry in the `lookups.xml` for the lookup dialog. You also need to associate the\nlookup name to the MBO attribute in the corresponding presentation xml(s). In the following example, you\nwrite a lookup for the \"address5\" attribute in the Address MBO for the multisite application. The\n\"address5\" maps to a country name using the country code. For example, you want to use some of the\nexternal rest APIs available that provides the list of countries. There are a number of APIs that can be used. However, for this example, a simple HTTP GET call with a user/password (basic auth) and a response is being used:\n\n```json\n{\"USA\" : \"United State Of America\", \"CAN\":\"Canada\", \"GBR\": \"United Kingdom\"}\n```\n\nYou must then write the \"retrieve list\" script. This example is in Nashorn JS, as a sample JS and to leverage some of the \nnative json parsing capabilities of Nashorn JS. \n\n```javascript\nimportPackage(java.util)\nimportPackage(Packages.psdi.server)\n\nvar jsonResp = service.httpget(\"..url..\",\"..userid..\",\"..password..\");\nvar countries = JSON.parse(jsonResp);\nvar countriesSet = MXServer.getMXServer().getMboSet(\"COUNTRY\", userInfo);\nfor(var cnt in countries)\n{\n\tvar cntMbo = countriesSet.add();\n\tcntMbo.setValue(\"name\",cnt);\n\tcntMbo.setValue(\"description\",countries[cnt]);\n}\nlistMboSet = countriesSet;\nsrcKeys=[\"NAME\"];\ntargetKeys=[\"ADDRESS5\"];\n```\n\nThe implicit variable `listMboSet` holds the MBOSET to be\nused in the lookup. The target MBO attribute where the value is going to be set has a different name\n(address5) from the src attribute name (\"name\" in COUNTRY MBO). Therefore, you must use the implicit vars\n`srcKeys` and `targetKeys` to let the system know where to set the selected value.\n\n\n### Init and init value attribute events\n\n\nThe Init and Init Value attributes events help set the attribute flags (init event) and initialize the value (init value event). \nYou can also do this using the Object init event but that can affect performance. \nThese Attribute events leverage the Maximo frameworks for just-in-time initialization. The scripts are called only if the framework needs to access that attribute.\nObject init event would initialize the attribute whether it is needed or not.\n\n\nThe following sample script is used to initialize the \"priority\" attribute:\n\n\n```\nif mbo.toBeAdded()==True and mbo.getString(\"site\")==\"BEDFORD\":\n  thisvalue = 1\n```\n\n**Note:** The implicit variable `thisvalue` represents the attribute for this launch point.\n\n\nSimilarly, the \"init\" event provides implicit variables for setting the required/readonly and hidden flags.\n\n\n|Variable name|Variable type|Purpose|\n|:-----------|:---------|:-------------------|\n|thisvalue_required|OUT|Sets the attribute to be required or not|\n|thisvalue_readonly|OUT|Sets the attribute to be readonly or not|\n|thisvalue_hidden|OUT|Sets the attribute to be hidden or not|\n\n\nThe following sample script is for this event:\n\n\n```\nif mbo.toBeAdded()==True and mbo.getString(\"site\")==\"BEDFORD\":\n  thisvalue_required = True\n```\n\nYou can set flags to the attribute (for this launch point) conditionally and the framework will invoke this only when it is being referred to.  ","type":"Mdx","contentDigest":"019af35022725b451fbd33c48b80adb4","owner":"gatsby-plugin-mdx","counter":183},"frontmatter":{"title":"Attribute launch point"},"exports":{},"rawBody":"---\ntitle: Attribute launch point\n---\n\n## Attribute launch point\nYou can use the Attribute launch point to customize the field\nvalidation, action, initialization, and lookups in the scripting framework. The script can access to the event MBO using the implicit variable “mbo” as well as all the\nrelated MBOs. Additionally,the modified attribute would also be available implicitly\nas a variable inside the script. The variable name would be the lower case value\nof the modified attribute name. The script will have access to the event MBO using the implicit variable\n\"mbo\", the MboSet as well as all the related MBOs. The following examples explain the Attribute launch point. \nTo design scripts using Attribute launch point, start the **Create Scripts with Attribute Launch Point** wizard.\n\n![Attribute Launchpoint UI](alpui.jpg)\n\n\n### Validate and action events\nYou can customise the Asset MBO by adding custom business logic based on the Asset purchase price or attribute\npurchaseprice in Asset value. For example, to set the vendor field to\nrequired or not required based on the purchaseprice attribute value and also to\ncalculate the replacement cost based on the purchase price. You should also ensure that the purchase price does not exceed a maximum allowed value.  \n\nThe logic has to be injected at the modification\nof the purchasprice attribute value, which implies that it should be modeled as an\nAttribute Launch Point. There is a validation element in the requirement, where the purchaseprice cannot exceed a certain limit. \nThere is also an action element wherein the state of the vendor attribute and the replacementcost value gets set based on the purchaseprice value. \nThe first requirement (of validation) should be handled by the Attribute validate event and the second requirement should be handled in the Attribute action event. \nThe following figure shows the events available in Atribute Launchpoint wizard.\n\n\n![Attribute Event](aeuipage1.jpg)\n\nThe \"validate\" script should be quite simple:\n\n```python\nif purchaseprice > 200:\n  service.error(\"some\",\"error\")\n```\n\nYou can use the implicit variable `purchaseprice`, which is attribute on which the launch point is based on, and also use the `service.error(..) to throw the needed MXException for this validation.  \n\n\nThe following script would be for the Attribute Action event:\n\n```python\nif purchaseprice >= 100:\n  vend_required=True\nelse:\n  vend_required=False\n  rc = purchaseprice/2\n```\nThis script leverages two explicitly defined OUT variables, `vend` for attribute \"vendor\" and `rc` for attribute \"replacementcost\".\nBy leveraging the implicit variable vend_required you can control the state of the \"vendor\" attribute to required or not required. You can also set the \"replacementcost\" by setting the `rc`.\nAnother way to do this without using any of these explicitly defined variables is to leverage the standard MBO APIs and the implict \"mbo\" variable.  \n\n\n```python\nfrom psdi.mbo import MboConstants\n\nif purchaseprice >= 100:\n  mbo.setFieldFlag(\"vendor\",MboConstants.READONLY, True)\nelse:\n  mbo.setFieldFlag(\"vendor\",MboConstants.READONLY, False)\n  mbo.setValue(\"replacementcost\",purchaseprice/2)\n```  \nIf you use the standard MBO APIs and the implicit \"mbo\" variable, you have more control but you must be aware of the MBO APIs.\nFor example, if the \"replacementcost\" field is readonly, both scripts will fail as the MBO framework will reject the `setValue` call \non that attribute. \nA possible workaround is to leverage the variable binding metadata - \"Suppress Access Control\". By setting this metadata, the scripting framework can set the `rc` variable value to the \"replacementcost\" whether it is readonly or not.\nHowever, this will only work if the script code uses the variable binding. For scripts that use the MBO APIs, the script code will need to leverage the MboConstants setting to achieve the same.\n\n```python\nfrom psdi.mbo import MboConstants\n..\nmbo.setValue(\"replacementcost\",purchaseprice/2, MboConstants.NOACCESSCHECK)\n```  \n\nAnother use case is to make the calculated field created\nfor the Asset sparepart total quantity calculation more real-time. For example, if\nYou change the quantities of the related spareparts you should see the calculated\nfield [sparepartqty] value change real-time. To achieve this, you need to create a\nscript - attribute launchpoint for attribute \"quantity\" for \"sparepart\" object with the \"Action\" event. The explicit\nvariable binding is shown in the following table:  \n\n\n|Variable name|Variable type|Binding|\n|:-----------|:--------|:----------------------|\n|sptqt|INOUT|&owner&.sparepartqty|\n\n\nThe variable sptqt is bound to the owner's [Asset\nmbo] sparepartqty attribute. You must set the sptqt variable with the \"No\nAccess Check\" as it is marked as readonly by our original [Object launch point]\nscript when initializing the Asset MBO. The variable\nquantity, which is the attribute on which the script is listening to would be implicitly\ninjected in the script as that is the attribute on which the script is listening. The following script shows how it will look:\n\n\n```python\nsptqt=sptqt+quantity-quantity_previous\n```\n\n\nThe use of the implicit variable quantity_previous represents\nthe value of the quantity attribute before the modification, which is the value at the\ninitialization of the sparepart MBO. The variable quantity holds the\ncurrent modified value of the quantity attribute.  \n\n\nThe script and the Object Launch point script can give\nyou a complete calculated field logic implemented using the scripting framework\nwith three lines of script and simply executing the Script Wizard.  \n\n**Note:** Maximo formulas provide a simpler way to handle this use case. \n\n\n\n### Creating lookups using scripts\n\nYou can create lookups using the attribute launch point **Retrieve List** option. As with any\nattribute launchpoint, you must hook the script up with the MBO attribute on which you\nwant the lookup to happen. While writing the script is enough for lookups to work from REST APIs (`GET getlist~attr`), it is not enough for lookups to work either in Graphite or in classic UI. \nFor classic UI you are required to make an entry in the `lookups.xml` for the lookup dialog. You also need to associate the\nlookup name to the MBO attribute in the corresponding presentation xml(s). In the following example, you\nwrite a lookup for the \"address5\" attribute in the Address MBO for the multisite application. The\n\"address5\" maps to a country name using the country code. For example, you want to use some of the\nexternal rest APIs available that provides the list of countries. There are a number of APIs that can be used. However, for this example, a simple HTTP GET call with a user/password (basic auth) and a response is being used:\n\n```json\n{\"USA\" : \"United State Of America\", \"CAN\":\"Canada\", \"GBR\": \"United Kingdom\"}\n```\n\nYou must then write the \"retrieve list\" script. This example is in Nashorn JS, as a sample JS and to leverage some of the \nnative json parsing capabilities of Nashorn JS. \n\n```javascript\nimportPackage(java.util)\nimportPackage(Packages.psdi.server)\n\nvar jsonResp = service.httpget(\"..url..\",\"..userid..\",\"..password..\");\nvar countries = JSON.parse(jsonResp);\nvar countriesSet = MXServer.getMXServer().getMboSet(\"COUNTRY\", userInfo);\nfor(var cnt in countries)\n{\n\tvar cntMbo = countriesSet.add();\n\tcntMbo.setValue(\"name\",cnt);\n\tcntMbo.setValue(\"description\",countries[cnt]);\n}\nlistMboSet = countriesSet;\nsrcKeys=[\"NAME\"];\ntargetKeys=[\"ADDRESS5\"];\n```\n\nThe implicit variable `listMboSet` holds the MBOSET to be\nused in the lookup. The target MBO attribute where the value is going to be set has a different name\n(address5) from the src attribute name (\"name\" in COUNTRY MBO). Therefore, you must use the implicit vars\n`srcKeys` and `targetKeys` to let the system know where to set the selected value.\n\n\n### Init and init value attribute events\n\n\nThe Init and Init Value attributes events help set the attribute flags (init event) and initialize the value (init value event). \nYou can also do this using the Object init event but that can affect performance. \nThese Attribute events leverage the Maximo frameworks for just-in-time initialization. The scripts are called only if the framework needs to access that attribute.\nObject init event would initialize the attribute whether it is needed or not.\n\n\nThe following sample script is used to initialize the \"priority\" attribute:\n\n\n```\nif mbo.toBeAdded()==True and mbo.getString(\"site\")==\"BEDFORD\":\n  thisvalue = 1\n```\n\n**Note:** The implicit variable `thisvalue` represents the attribute for this launch point.\n\n\nSimilarly, the \"init\" event provides implicit variables for setting the required/readonly and hidden flags.\n\n\n|Variable name|Variable type|Purpose|\n|:-----------|:---------|:-------------------|\n|thisvalue_required|OUT|Sets the attribute to be required or not|\n|thisvalue_readonly|OUT|Sets the attribute to be readonly or not|\n|thisvalue_hidden|OUT|Sets the attribute to be hidden or not|\n\n\nThe following sample script is for this event:\n\n\n```\nif mbo.toBeAdded()==True and mbo.getString(\"site\")==\"BEDFORD\":\n  thisvalue_required = True\n```\n\nYou can set flags to the attribute (for this launch point) conditionally and the framework will invoke this only when it is being referred to.  ","fileAbsolutePath":"/home/travis/build/maximo-app-framework/maximo-autoscript-documentation/src/pages/attributescripts/attributelaunch.mdx"}}},
    "staticQueryHashes": ["1364590287","137577622","2102389209","2456312558","2746626797","3018647132","3037994772","768070550"]}