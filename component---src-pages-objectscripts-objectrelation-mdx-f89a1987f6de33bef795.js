"use strict";(self.webpackChunkmas_playbook=self.webpackChunkmas_playbook||[]).push([[3887],{445:function(e,t,a){a.r(t),a.d(t,{_frontmatter:function(){return o},default:function(){return c}});var n=a(3366),r=(a(7294),a(4983)),l=a(4295),i=["components"],o={},s={_frontmatter:o},m=l.Z;function c(e){var t=e.components,a=(0,n.Z)(e,i);return(0,r.kt)(m,Object.assign({},s,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"This is an automation script without a launch point. This is used to define smart relations - relations that need to leverage conditional sqls in the where clause."),(0,r.kt)("p",null,"The following examples are some scenarios where it may be useful:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Could be utilized to break a very complex sql where clause to simpler conditional blocks, thus improving performance in certain cases."),(0,r.kt)("li",{parentName:"ul"},"Could be utilized to handle a database fetch that is dependent on the state of the application or on some user input. These are not cases for parameterized sql, but cases where the structure of the sql changes drastically depending on the conditions.")),(0,r.kt)("p",null,"When the Mbo framework evaluates a relationship like ",(0,r.kt)("inlineCode",{parentName:"p"},'mbo.getMboSet("relation")'),", it figures out if the relation where is implemented by an automation script based on the registration of the relation ",(0,r.kt)("inlineCode",{parentName:"p"},"relation")," in the MAXREALATIONSHIP table.\nThe relation where clause should contain the expression ",(0,r.kt)("inlineCode",{parentName:"p"},"script:<script name>")," for the framework to execute the script named ",(0,r.kt)("inlineCode",{parentName:"p"},"<script name>"),"."),(0,r.kt)("h2",null,"Implicit variables"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:"left"},"Variable name"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"mbo"),(0,r.kt)("td",{parentName:"tr",align:"left"},"The source MBO record. This is inpput to the script.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"mboset"),(0,r.kt)("td",{parentName:"tr",align:"left"},"The response MboSet instance that is the target or the relation. The script is expected to create this mboset")))),(0,r.kt)("h2",null,"Example Script"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},'if mbo.isNull("priority")==False:\n mboset = mbo.getMboSet("openwo")\nelse:\n mboset = mbo.getMboSet("allwo")\n')),(0,r.kt)("p",null,"Another advanced use case would be to pass certain context information from an app to the backend using api call. A sample REST call shown below:"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"GET /api/os/mxapiwo?oslc.select=rel.asset{assetnum,rel.assetmeter{lastreading}}&ctx=param1=value1")),(0,r.kt)("p",null,"Say we want to introduce some smart filtering on the assetmeter relation. We can replace this relation in the url with a custom one."),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"GET /api/os/mxapiwo?oslc.select=rel.asset{assetnum,rel.custassetmeter{lastreading}}&ctx=param1=value1")),(0,r.kt)("p",null,"Now custassetmeter can be backed by an relation script that can leverage the information passed in the ",(0,r.kt)("inlineCode",{parentName:"p"},"ctx")," from the script and can come up with a smart where clause."),(0,r.kt)("h2",null,"Example Script"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},'from psdi.iface.mic import IntegrationContext\nif IntegrationContext.getCurrentContext() is not None and IntegrationContext.getCurrentContext().isAPICall(): \n  val1 = IntegrationContext.getCurrentContext().getParameter("param1")\n  #create a filter clause based on the val1 and set the mboset\nelse:\n  mboset = mbo.getMboSet("assetmeter")\n')))}c.isMDXComponent=!0},4295:function(e,t,a){a.d(t,{Z:function(){return v}});var n=a(7294),r=a(8650),l=a.n(r),i=a(5444),o=a(6949),s=a(3293),m=a(5900),c=a.n(m),p=function(e){var t,a=e.title,r=e.theme,l=e.tabs,i=void 0===l?[]:l;return n.createElement("div",{className:c()("PageHeader-module--page-header--NqfPe",(t={},t["PageHeader-module--with-tabs--vbQ-W"]=i.length,t["PageHeader-module--dark-mode--WCeH8"]="dark"===r,t))},n.createElement("div",{className:"bx--grid"},n.createElement("div",{className:"bx--row"},n.createElement("div",{className:"bx--col-lg-12"},n.createElement("h1",{id:"page-title",className:"PageHeader-module--text--Er2EO"},a)))))},u=function(e){var t=e.relativePagePath,a=e.repository,r=(0,i.useStaticQuery)("1364590287").site.siteMetadata.repository,l=a||r,o=l.baseUrl,s=l.subDirectory,m=o+"/edit/"+l.branch+s+"/src/pages"+t;return o?n.createElement("div",{className:"bx--row EditLink-module--row--BEmSX"},n.createElement("div",{className:"bx--col"},n.createElement("a",{className:"EditLink-module--link--IDrl1",href:m},"Edit this page on GitHub"))):null},d=a(4275),h=a(1721),b=function(e){function t(){return e.apply(this,arguments)||this}return(0,h.Z)(t,e),t.prototype.render=function(){var e=this.props,t=e.title,a=e.tabs,r=e.slug,o=r.split("/").filter(Boolean).slice(-1)[0],s=a.map((function(e){var t,a=l()(e,{lower:!0,strict:!0}),s=a===o,m=new RegExp(o+"/?(#.*)?$"),p=r.replace(m,a);return n.createElement("li",{key:e,className:c()((t={},t["PageTabs-module--selected-item--aBB0K"]=s,t),"PageTabs-module--list-item--024o6")},n.createElement(i.Link,{className:"PageTabs-module--link--Kz-7R",to:""+p},e))}));return n.createElement("div",{className:"PageTabs-module--tabs-container--Cdfzw"},n.createElement("div",{className:"bx--grid"},n.createElement("div",{className:"bx--row"},n.createElement("div",{className:"bx--col-lg-12 bx--col-no-gutter"},n.createElement("nav",{"aria-label":t},n.createElement("ul",{className:"PageTabs-module--list--xLqxG"},s))))))},t}(n.Component),g=b,k=a(2881),f=a(6958),N=a(36),E=function(e){var t=e.date,a=new Date(t);return t?n.createElement(N.X2,{className:"last-modified-date-module--row--XJoYQ"},n.createElement(N.sg,null,n.createElement("div",{className:"last-modified-date-module--text--ogPQF"},"Page last updated: ",a.toLocaleDateString("en-GB",{day:"2-digit",year:"numeric",month:"long"})))):null},v=function(e){var t=e.pageContext,a=e.children,r=e.location,m=e.Title,c=t.frontmatter,h=void 0===c?{}:c,b=t.relativePagePath,N=t.titleType,v=h.tabs,w=h.title,x=h.theme,y=h.description,C=h.keywords,T=h.date,P=(0,f.Z)().interiorTheme,S=(0,i.useStaticQuery)("2456312558").site.pathPrefix,M=S?r.pathname.replace(S,""):r.pathname,I=v?M.split("/").filter(Boolean).slice(-1)[0]||l()(v[0],{lower:!0}):"",Z=x||P;return n.createElement(s.Z,{tabs:v,homepage:!1,theme:Z,pageTitle:w,pageDescription:y,pageKeywords:C,titleType:N},n.createElement(p,{title:m?n.createElement(m,null):w,label:"label",tabs:v,theme:Z}),v&&n.createElement(g,{title:w,slug:M,tabs:v,currentTab:I}),n.createElement(k.Z,{padded:!0},a,n.createElement(u,{relativePagePath:b}),n.createElement(E,{date:T})),n.createElement(d.Z,{pageContext:t,location:r,slug:M,tabs:v,currentTab:I}),n.createElement(o.Z,null))}}}]);
//# sourceMappingURL=component---src-pages-objectscripts-objectrelation-mdx-f89a1987f6de33bef795.js.map